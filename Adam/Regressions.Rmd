---
title: "Regressions"
author: "Adam Billen"
date: "12/3/2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(tidyverse)
library(nnet)
library(MASS)
library(rpart)
```
MPD regression

For this study, we will conduct four multiple regressions predicting the
use of force in Washington, DC by the Metropolitan Police Department.
Our predictors will be the police district in which the use of force
took place, the date of the incident, the gender and race of the officer
and the age, race, and gender of the subject. The targets will be the
type of use of force, the disposition, the department action, and the
severity of the force. We won't include the other potential targets as
predictors for one another because severity, for example, will likely be
a very high predictor of the type of use of force, muddling our models.
We will not include variables such as case status, when a case closed,
the anonymized officer IDs, or officer assignments as predictors. We
will remove all uses of force against animals, as we are only interested
in cases involving humans.\


```{r}
mpd_dat_2021 <- read.csv('../data/UOF_DC_2021.csv')
mpd_dat_2020 <- read.csv('../data/UOF_DC_2020.csv')
sea_dat <- read.csv('../data/UOF_Seattle.csv')
```



```{r}
age_breaks <- c(18, 25, 35, 45, 55, 65, 100)

mpd_dat_2021 <- mpd_dat_2021 %>%
  mutate(
    subject_age = as.numeric(subject_age),
    AgeBands = cut(subject_age, breaks = age_breaks, labels = c("18_24", "25_34", "35_44", "45_54", "55_65", "66_100"), include.lowest = TRUE, right = FALSE)) %>%
  drop_na(uof_type, IncidentDistrict, OfficerGender, OfficerRace, AgeBands, subject_race, subject_gender) %>%
  mutate(OfficerRace = str_replace_all(OfficerRace, "/", "_")) %>%
  mutate(OfficerRace = str_replace_all(OfficerRace, " ", "_")) %>%
  mutate(subject_race = str_replace_all(subject_race, " ", "_")) %>%
  mutate(subject_race = str_replace_all(subject_race, "/", "_"))

encoded_data <- model.matrix(~ uof_type + IncidentDistrict + OfficerGender + OfficerRace + AgeBands + subject_race + subject_gender, data = mpd_dat_2021)

mpd_dat_enc <- cbind(mpd_dat_2021, encoded_data)

model_seattle_2021 <- glm(serious ~ IncidentDistrict2D + IncidentDistrict3D + IncidentDistrict4D + IncidentDistrict5D + IncidentDistrict6D + IncidentDistrictOther + OfficerGenderMale + OfficerRaceBlack_African_American + OfficerRaceHispanic + OfficerRaceOther + OfficerRaceWhite_Caucasian + AgeBands25_34 + AgeBands35_44 + AgeBands45_54 + AgeBands55_65 + AgeBands66_100 + subject_raceBlack_African_American + subject_raceHispanic + subject_raceOther + subject_raceWhite_Caucasian + subject_genderMale,
               data = mpd_dat_enc)

summary(model_seattle_2021)
```
```{r}
mpd_dat_2020 <- mpd_dat_2020 %>%
  mutate(
    subject_age = as.numeric(subject_age),
    AgeBands = cut(subject_age, breaks = age_breaks, labels = c("18_24", "25_34", "35_44", "45_54", "55_65", "66_100"), include.lowest = TRUE, right = FALSE)) %>%
  drop_na(uof_type, IncidentDistrict, OfficerGender, OfficerRace, AgeBands, subject_race, subject_gender) %>%
  mutate(OfficerRace = str_replace_all(OfficerRace, "/", "_")) %>%
  mutate(OfficerRace = str_replace_all(OfficerRace, " ", "_")) %>%
  mutate(subject_race = str_replace_all(subject_race, " ", "_")) %>%
  mutate(subject_race = str_replace_all(subject_race, "/", "_"))

encoded_data_2020 <- model.matrix(~ uof_type + IncidentDistrict + OfficerGender + OfficerRace + AgeBands + subject_race + subject_gender, data = mpd_dat_2020)

mpd_dat_enc_2020 <- cbind(mpd_dat_2020, encoded_data)

model_seattle_2020 <- glm(serious ~ IncidentDistrict2D + IncidentDistrict3D + IncidentDistrict4D + IncidentDistrict5D + IncidentDistrict6D + IncidentDistrictOther + OfficerGenderMale + OfficerRaceHispanic + OfficerRaceOther + OfficerRaceWhite_Caucasian + AgeBands25_34 + AgeBands35_44 + AgeBands45_54 + AgeBands55_65 + AgeBands66_100 + subject_raceBlack_African_American + subject_raceHispanic + subject_raceWhite_Caucasian + subject_genderMale,
               data = mpd_dat_enc_2020)

summary(model_seattle_2020)
```
Seattle
```{r}
sea_dat <- read.csv('../data/UOF_Seattle.csv')

sea_dat <- sea_dat %>%
  mutate(datetime = mdy_hms(Occured_date_time)) %>%
  filter(year(datetime) == 2020) %>%
  drop_na(Incident_Type, Subject_Race, Subject_Gender, Precinct, Sector, Beat) %>%
  mutate(Incident_Type = ifelse(Incident_Type == "Level 1 - Use of Force", 0, 1))

encoded_data_2020 <- model.matrix(~ Incident_Type + Subject_Race + Subject_Gender + Precinct + Sector + Beat, data = mpd_dat_2020)


```

